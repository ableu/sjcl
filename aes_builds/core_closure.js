"use strict";var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};
sjcl.cipher.aes=function(a){if(!this.a[0][0][0]){var e=this.a[0],h=this.a[1],d=e[4],k=h[4],c,f,b,m=[],p=[],q,l,g,n;for(c=0;0x100>c;c++)p[(m[c]=c<<1^283*(c>>7))^c]=c;for(f=b=0;!d[f];f^=q||1,b=p[b]||1)for(g=b^b<<1^b<<2^b<<3^b<<4,g=g>>8^g&255^99,d[f]=g,k[g]=f,l=m[c=m[q=m[f]]],n=0x1010101*l^0x10001*c^0x101*q^0x1010100*f,l=0x101*m[g]^0x1010100*g,c=0;4>c;c++)e[c][f]=l=l<<24^l>>>8,h[c][g]=n=n<<24^n>>>8;for(c=0;5>c;c++)e[c]=e[c].slice(0),h[c]=h[c].slice(0)}e=this.a[0][4];h=this.a[1];b=a.length;m=1;if(4!==b&&6!==b&&
8!==b)throw new sjcl.exception.invalid("invalid aes key size");this.b=[k=a.slice(0),f=[]];for(a=b;a<4*b+28;a++){d=k[a-1];if(0===a%b||8===b&&4===a%b)d=e[d>>>24]<<24^e[d>>16&255]<<16^e[d>>8&255]<<8^e[d&255],0===a%b&&(d=d<<8^d>>>24^m<<24,m=m<<1^283*(m>>7));k[a]=k[a-b]^d}for(b=0;a;b++,a--)d=k[b&3?a:a-4],f[b]=4>=a||4>b?d:h[0][e[d>>>24]]^h[1][e[d>>16&255]]^h[2][e[d>>8&255]]^h[3][e[d&255]]};
sjcl.cipher.aes.prototype={encrypt:function(a){return w(this,a,0)},decrypt:function(a){return w(this,a,1)},a:[[[],[],[],[],[]],[[],[],[],[],[]]]};
function w(a,e,h){if(4!==e.length)throw new sjcl.exception.invalid("invalid aes block size");var d=a.b[h],k=e[0]^d[0],c=e[h?3:1]^d[1],f=e[2]^d[2];e=e[h?1:3]^d[3];var b,m,p,q=d.length/4-2,l,g=4,n=[0,0,0,0];b=a.a[h];a=b[0];var r=b[1],t=b[2],u=b[3],v=b[4];for(l=0;l<q;l++)b=a[k>>>24]^r[c>>16&255]^t[f>>8&255]^u[e&255]^d[g],m=a[c>>>24]^r[f>>16&255]^t[e>>8&255]^u[k&255]^d[g+1],p=a[f>>>24]^r[e>>16&255]^t[k>>8&255]^u[c&255]^d[g+2],e=a[e>>>24]^r[k>>16&255]^t[c>>8&255]^u[f&255]^d[g+3],g+=4,k=b,c=m,f=p;for(l=
0;4>l;l++)n[h?3&-l:l]=v[k>>>24]<<24^v[c>>16&255]<<16^v[f>>8&255]<<8^v[e&255]^d[g++],b=k,k=c,c=f,f=e,e=b;return n}"undefined"!==typeof module&&module.exports&&(module.exports=sjcl);"function"===typeof define&&define([],function(){return sjcl});
